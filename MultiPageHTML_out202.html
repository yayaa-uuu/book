<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_215.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_215.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:7.7708em;top:4.5292em;"><span class="stl_200 stl_171 stl_28">key: idx_actor_last_name &nbsp;</span></div>
					<div class="stl_01" style="left:7.7708em;top:5.3792em;"><span class="stl_200 stl_171 stl_28" style="word-spacing:0em;">key_len: 182 &nbsp;</span></div>
					<div class="stl_01" style="left:7.7708em;top:6.2292em;"><span class="stl_200 stl_171 stl_28">ref: const &nbsp;</span></div>
					<div class="stl_01" style="left:7.7708em;top:7.0792em;"><span class="stl_200 stl_171 stl_28">rows: 2 &nbsp;</span></div>
					<div class="stl_01" style="left:7.7708em;top:7.9292em;"><span class="stl_200 stl_171 stl_28">filtered: 100.00 &nbsp;</span></div>
					<div class="stl_01" style="left:7.7708em;top:8.7792em;"><span class="stl_200 stl_171 stl_28">Extra: Using index &nbsp;</span></div>
					<div class="stl_01" style="left:6.0005em;top:10.2509em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Using Index Scans for Sorts &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:12.1507em;"><span class="stl_154 stl_32 stl_46" style="word-spacing:0.0281em;">MySQL has two ways to produce ordered results: it can use a sort operation, or it can &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:13.2007em;z-index:291;"><span class="stl_154 stl_32 stl_107" style="word-spacing:0.0738em;">scan an index in order. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0668em;">u can tell when MySQL plans to scan an index by looking &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:14.3001em;"><span class="stl_154 stl_32 stl_143" style="word-spacing:0.0335em;">for “index” in the </span><span class="stl_170 stl_171 stl_28">typ</span><span class="stl_170 stl_171 stl_369">e</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0279em;">column in </span><span class="stl_170 stl_171 stl_28">EXPLAIN</span><span class="stl_154 stl_32 stl_144" style="word-spacing:0.04em;">. (Don’t confuse this with “Using index” in &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:15.3995em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">the </span><span class="stl_170 stl_171 stl_28">Extr</span><span class="stl_170 stl_171 stl_186">a</span><span class="stl_154 stl_32 stl_28">column.) &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:16.9495em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.1365em;">Scanning the index itself is fast because it simply requires moving from one index &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:17.9995em;"><span class="stl_154 stl_32 stl_139" style="word-spacing:0.0723em;">entry to the next. However, if MySQL isn’t using the index to cover the query, it will &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:19.0495em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0484em;">have to look up each row it finds in the index. This is basically random I/O, so read‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:20.0995em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.0434em;">ing data in index order is usually slower than a sequential table scan, especially for I/ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:21.1495em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">O-bound workloads. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:22.6996em;z-index:786;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.1014em;">MySQL can use the same index for both sorting and finding rows. If possible, it</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.099em;">s a &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:23.7495em;"><span class="stl_154 stl_32 stl_48" style="word-spacing:0.0036em;">good idea to design your indexes so that they’re useful for both tasks at once. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:25.2996em;z-index:904;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1258em;">Ordering the results by the index works only when the index</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1258em;">s </span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1258em;">rder is exactly the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:26.399em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.256em;">same as the </span><span class="stl_170 stl_171 stl_28" style="word-spacing:0.1322em;">ORDER BY </span><span class="stl_154 stl_32 stl_88" style="word-spacing:0.2571em;">clause and all columns are sorted in the same direction &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:27.449em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.037em;">(ascending or descending).</span><sup style="top: -0.2917em;"><a href="MultiPageHTML_out202.html#202_1"><span class="stl_166 stl_32 stl_28" style="word-spacing:0.235em;">10 </span></a></sup><span class="stl_154 stl_32 stl_126" style="word-spacing:0.0365em;">If the query joins multiple tables, it works only when all &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:28.5484em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0581em;">columns in the </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0709em;">ORDER BY </span><span class="stl_154 stl_32 stl_74" style="word-spacing:0.0597em;">clause refer to the first table. The </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0709em;">ORDER BY </span><span class="stl_154 stl_32 stl_36" style="word-spacing:0.0619em;">clause also has &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:29.5984em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0379em;">the same limitation as lookup queries: it needs to form a leftmost prefix of the index. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:30.6484em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.0028em;">In all other cases, MySQL uses a sort. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:32.2479em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0964em;">One case where the </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0316em;">ORDER BY </span><span class="stl_154 stl_32 stl_55" style="word-spacing:0.1039em;">clause doesn’t have to specify a leftmost prefix of the &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:33.3473em;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.0739em;">index is if there are constants for the leading columns. If the </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.1843em;">WHERE </span><span class="stl_154 stl_32 stl_99" style="word-spacing:0.0793em;">clause or a </span><span class="stl_170 stl_171 stl_28">JOIN &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:34.3973em;"><span class="stl_154 stl_32 stl_84" style="word-spacing:0.0045em;">clause specifies constants for these columns, they can “fill the gaps” in the index. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:35.9967em;"><span class="stl_154 stl_32 stl_124" style="word-spacing:0.1025em;">For example, the </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.1604em;">rental </span><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0976em;">table in the standard Sakila Sample Database has an index &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:37.0962em;"><span class="stl_154 stl_32 stl_189" style="word-spacing:-0.0009em;">on (</span><span class="stl_170 stl_171 stl_28">rental_date</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">, </span><span class="stl_170 stl_171 stl_28">inventory_id</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">, </span><span class="stl_170 stl_171 stl_28">customer_id</span><span class="stl_154 stl_32 stl_28">): &nbsp;</span></div>
					<div class="stl_01" style="left:7.4169em;top:38.8588em;"><span class="stl_200 stl_171 stl_28">CREATE TABLE rental ( &nbsp;</span></div>
					<div class="stl_01" style="left:7.771em;top:39.7088em;"><span class="stl_200 stl_171 stl_28">... &nbsp;</span></div>
					<div class="stl_01" style="left:7.771em;top:40.5588em;"><span class="stl_200 stl_171 stl_28">PRIMARY KEY (rental_id), &nbsp;</span></div>
					<div class="stl_01" style="left:7.771em;top:41.4088em;"><span class="stl_200 stl_171 stl_28">UNIQUE KEY rental_date (rental_date,inventory_id,customer_id), &nbsp;</span></div>
					<div class="stl_01" style="left:7.771em;top:42.2588em;"><span class="stl_200 stl_171 stl_28">KEY idx_fk_inventory_id (inventory_id), &nbsp;</span></div>
					<div class="stl_01" style="left:7.771em;top:43.1088em;"><span class="stl_200 stl_171 stl_28">KEY idx_fk_customer_id (customer_id), &nbsp;</span></div>
					<div class="stl_01" style="left:7.771em;top:43.9588em;"><span class="stl_200 stl_171 stl_28">KEY idx_fk_staff_id (staff_id), &nbsp;</span></div>
					<div class="stl_01" style="left:5.815em;top:48.1878em;"><span class="stl_167 stl_32 stl_28" style="word-spacing:0.273em;">10 </span><span class="stl_168 stl_32 stl_74" style="word-spacing:0.0016em;">If you need to sort in different directions, a trick that sometimes helps is to store a reversed or negated value. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">180 &nbsp;</span></div>
					<div class="stl_01" style="left:7.6682em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:8.5757em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Chapter 7: Indexing for High Performance &nbsp;</span></div>
					<a name="202_0" style="position:absolute;left:0em;top:10.544em;">&nbsp;</a>
					<a name="202_1" style="position:absolute;left:0em;top:48.2792em;">&nbsp;</a>
					<a name="202_2" style="position:absolute;left:0em;top:12.3799em;">&nbsp;</a>
					<a name="202_3" style="position:absolute;left:0em;top:25.5288em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>