<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_229.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_229.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:7.4998em;top:4.3166em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.107em;">to a list of comments, you might request this repeatedly for each comment. Or &nbsp;</span></div>
					<div class="stl_01" style="left:7.5001em;top:5.3666em;"><span class="stl_154 stl_32 stl_77" style="word-spacing:0.1324em;">you could cache it the first time you fetch it and reuse it thereafter. The latter &nbsp;</span></div>
					<div class="stl_01" style="left:7.4996em;top:6.4166em;"><span class="stl_154 stl_32 stl_114" style="word-spacing:0.005em;">approach is much more efficient. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:8.3009em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Is MySQL Examining Too Much Data? &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:10.1893em;"><span class="stl_154 stl_32 stl_51" style="word-spacing:0.0399em;">Once you’re sure your queries </span><span class="stl_155 stl_41 stl_17" style="word-spacing:0.0386em;">retrieve </span><span class="stl_154 stl_32 stl_78" style="word-spacing:0.0334em;">only the data you need, you can look for quer‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:11.2393em;"><span class="stl_154 stl_32 stl_55" style="word-spacing:0.1997em;">ies that </span><span class="stl_155 stl_41 stl_93" style="word-spacing:0.2061em;">examine </span><span class="stl_154 stl_32 stl_114" style="word-spacing:0.1972em;">too much data while generating results. In MySQL, the simplest &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:12.3007em;"><span class="stl_154 stl_32 stl_247" style="word-spacing:-0.0036em;">query cost metrics are: &nbsp;</span></div>
					<div class="stl_01" style="left:6.7209em;top:14.184em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.2731em;">• Response</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">&nbsp;</span><span class="stl_154 stl_32 stl_28">time &nbsp;</span></div>
					<div class="stl_01" style="left:6.7213em;top:15.5673em;"><span class="stl_154 stl_32 stl_65" style="word-spacing:0.2867em;">• Number</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.007em;">&nbsp;</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">of rows examined &nbsp;</span></div>
					<div class="stl_01" style="left:6.7213em;top:16.9507em;"><span class="stl_154 stl_32 stl_65" style="word-spacing:0.2867em;">• Number</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.007em;">&nbsp;</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">of rows returned &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:18.834em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0266em;">None of these metrics is a perfect way to measure query cost, but they reflect roughly &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:19.884em;"><span class="stl_154 stl_32 stl_54" style="word-spacing:0.2498em;">how much data MySQL must access internally to execute a query and translate &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:20.934em;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.0682em;">approximately into how fast the query runs. All three metrics are logged in the slow &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:21.984em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0269em;">query log, so looking at the slow query log is one of the best ways to find queries that &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:23.034em;"><span class="stl_154 stl_32 stl_114" style="word-spacing:0.0051em;">examine too much data. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:25.0909em;"><span class="stl_193 stl_27 stl_28" style="word-spacing:0em;">Response time &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:26.5583em;"><span class="stl_154 stl_32 stl_55" style="word-spacing:0.1546em;">Beware of taking query response time at face value. Hey, isn’t that the opposite of &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:27.6083em;"><span class="stl_154 stl_32 stl_98" style="word-spacing:0.086em;">what we’ve been telling you? Not really. It’s still true that response time is what mat‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:28.6583em;z-index:858;"><span class="stl_154 stl_32 stl_222" style="word-spacing:0.0067em;">ters, but it</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">s a </span><span class="stl_154 stl_32 stl_28">b</span><span class="stl_154 stl_32 stl_99" style="word-spacing:0.0063em;">it complicated. &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:30.197em;"><span class="stl_154 stl_32 stl_188" style="word-spacing:0.0606em;">Response time is the sum of two things: service time and queue time. </span><span class="stl_155 stl_41 stl_122" style="word-spacing:0.0612em;">Service time </span><span class="stl_154 stl_32 stl_28">is &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:31.247em;z-index:993;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0087em;">how long it takes the server to actually process the query. </span><span class="stl_155 stl_41 stl_183" style="word-spacing:0.0164em;">Queue time </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">is the portion of &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:32.3083em;z-index:1081;"><span class="stl_154 stl_32 stl_77" style="word-spacing:0.128em;">response time during which the server isn’t really executing the query—it</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1248em;">s </span><span class="stl_154 stl_32 stl_28">w</span><span class="stl_154 stl_32 stl_28">aiting &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:33.3583em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.1076em;">for something, such as waiting for an I/O operation to complete, waiting for a row &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:34.4083em;"><span class="stl_154 stl_32 stl_114" style="word-spacing:0.0298em;">lock, and so forth. The problem is, you can’t break the response time down into these &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:35.4583em;"><span class="stl_154 stl_32 stl_114" style="word-spacing:0.0856em;">components unless you can measure them individually, which is usually hard to do. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:36.5083em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0512em;">In general, the most common and important waits you’ll encounter are I/O and lock &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:37.5584em;"><span class="stl_154 stl_32 stl_71" style="word-spacing:0.0954em;">waits, but you shouldn’t count on it being just those two because it varies a lot. I/O &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:38.6084em;"><span class="stl_154 stl_32 stl_46" style="word-spacing:0.0027em;">and lock waits are important because they are the most detrimental to performance. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:40.1583em;"><span class="stl_154 stl_32 stl_37" style="word-spacing:0.0296em;">As a result, response time is not consistent under varying load conditions. Other fac‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:41.2084em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0722em;">tors—such as storage engine locks (like row locks), high concurrency, and hardware &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:42.2583em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0683em;">—can have a considerable impact on response times, too. Response time can also be &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:43.3084em;z-index:1754;"><span class="stl_154 stl_32 stl_84" style="word-spacing:0.1266em;">both a symptom and a cause of problems, and it</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.122em;">s </span><span class="stl_154 stl_32 stl_28">n</span><span class="stl_154 stl_32 stl_95" style="word-spacing:0.1239em;">ot always obvious which is the &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:44.3584em;"><span class="stl_154 stl_32 stl_28">case. &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:45.9083em;z-index:1806;"><span class="stl_154 stl_32 stl_188" style="word-spacing:0.2095em;">When you look at a query</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.211em;">s </span><span class="stl_154 stl_32 stl_28">r</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.211em;">esponse time, you should ask yourself whether the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:46.9583em;z-index:1887;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.0284em;">response time is reasonable for the query. </span><span class="stl_154 stl_32 stl_52">W</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0253em;">e </span><span class="stl_154 stl_32 stl_28">d</span><span class="stl_154 stl_32 stl_100" style="word-spacing:0.0356em;">on’t have space for a detailed explana‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:48.0083em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.2716em;">tion in this book, but you can actually calculate a quick upper-bound estimate &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">194 &nbsp;</span></div>
					<div class="stl_01" style="left:7.6684em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:8.5759em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Chapter 8: Query Performance Optimization &nbsp;</span></div>
					<a name="216_0" style="position:absolute;left:0em;top:8.594em;">&nbsp;</a>
					<a name="216_1" style="position:absolute;left:0em;top:10.4299em;">&nbsp;</a>
					<a name="216_2" style="position:absolute;left:0em;top:26.7876em;">&nbsp;</a>
					<a name="216_3" style="position:absolute;left:0em;top:30.4376em;">&nbsp;</a>
					<a name="216_4" style="position:absolute;left:0em;top:48.2376em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>