<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_61.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_61.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:6em;top:4.3166em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.1402em;">data has inconsistencies as you send reads to replicas not yet caught up on all the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:5.3666em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0204em;">changes. In a social media example, a user may comment on something someone else &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:6.4166em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.0639em;">has posted. This data is written to the source and then replicated out to the replicas. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:7.4666em;"><span class="stl_154 stl_32 stl_143" style="word-spacing:0.0903em;">When the user attempts to view their reply, if the application sends the request to a &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:8.5166em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0433em;">server that is lagged, the replica may not have the data yet. This can create confusion &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:9.5666em;z-index:396;"><span class="stl_154 stl_32 stl_71" style="word-spacing:0.026em;">for the user, thinking their comment was not saved. </span><span class="stl_154 stl_32 stl_52">W</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0201em;">e </span><span class="stl_154 stl_32 stl_28">c</span><span class="stl_154 stl_32 stl_39" style="word-spacing:0.0236em;">over strategies to fight repli‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:10.6166em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0022em;">cation lag in more detail in </span><a href="MultiPageHTML_out249.html#249_0"><span class="stl_184 stl_32 stl_24" style="word-spacing:0.0054em;">Chapter 9</span></a><span class="stl_154 stl_32 stl_24" style="word-spacing:0.0054em;">. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:12.1666em;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.1093em;">Lag is one of those metrics that can be an acute SLI that can trigger incidents. It is &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:13.2166em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.1445em;">also a longer-term trend indicating the need for more architectural change. In the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:14.2666em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.1543em;">longer-term context, even if you never hit replication lag that is affecting the cus‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:15.3166em;"><span class="stl_154 stl_32 stl_114" style="word-spacing:0.1397em;">tomer experience, it is still a sign that, at least intermittently, the volume of writes &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:16.3666em;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.1058em;">from source nodes is surpassing what replicas can write at current configuration. It &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:17.4166em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.0551em;">can be a canary in the coal mine for your write capacity. If listened to, it can prevent &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:18.4666em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.0017em;">future full-blown incidents. &nbsp;</span></div>
					<div class="stl_01" style="left:11.3993em;top:20.7787em;"><span class="stl_176 stl_32 stl_37" style="word-spacing:0.0332em;">Be wary of alerting someone to replication lag. Immediate actiona‐ &nbsp;</span></div>
					<div class="stl_01" style="left:11.3993em;top:21.7387em;"><span class="stl_176 stl_32 stl_55" style="word-spacing:0.0906em;">ble remediation may not always be possible. Likewise, if you don’t &nbsp;</span></div>
					<div class="stl_01" style="left:11.3993em;top:22.6987em;"><span class="stl_176 stl_32 stl_28" style="word-spacing:0.0193em;">read from replicas, consider how aggressively your monitoring sys‐ &nbsp;</span></div>
					<div class="stl_01" style="left:11.3994em;top:23.6587em;"><span class="stl_176 stl_32 stl_140" style="word-spacing:0.0285em;">tem alerts someone to this condition. Alerts that someone receives, &nbsp;</span></div>
					<div class="stl_01" style="left:11.3994em;top:24.6187em;"><span class="stl_176 stl_32 stl_88" style="word-spacing:0.001em;">especially off hours, should always be actionable. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:26.8166em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.1489em;">Replication lag is one of those metrics that can affect both immediate and tactical &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:27.8666em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0103em;">decisions, but also keeping an eye on its trends long term can help save you the hassle &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:28.9166em;"><span class="stl_154 stl_32 stl_37" style="word-spacing:-0.0005em;">of larger business impact and keep you ahead of the growth curve. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:30.9735em;"><span class="stl_193 stl_27 stl_28" style="word-spacing:0em;">I/O utilization &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:32.4409em;"><span class="stl_154 stl_32 stl_120" style="word-spacing:0.0277em;">One of the never-ending endeavors of a database engineer is “do as much of the work &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:33.4909em;z-index:1496;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.1117em;">as possible in memory because it is faster</span><span class="stl_154 stl_32 stl_161">.</span><span class="stl_154 stl_32 stl_35" style="word-spacing:0.1106em;">” While that is certainly accurate, we also &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:34.5409em;"><span class="stl_154 stl_32 stl_48" style="word-spacing:0.0834em;">know that we cannot possibly accomplish that 100% of the time because that would &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:35.5909em;"><span class="stl_154 stl_32 stl_55" style="word-spacing:0.0156em;">mean our data entirely fits in memory, in which case “scale” is not yet a thing we need &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:36.6409em;"><span class="stl_154 stl_32 stl_247" style="word-spacing:-0.0037em;">to expend energy on. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:38.1909em;"><span class="stl_154 stl_32 stl_53" style="word-spacing:0.1541em;">As your database infrastructure scales and your data does not fit in memory any‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:39.2409em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0758em;">more, you come to realize that the next best thing is to not read so much data from &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:40.2909em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.2084em;">disk that queries are stuck waiting their turn for those precious I/O cycles. This &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:41.3409em;"><span class="stl_154 stl_32 stl_37" style="word-spacing:0.0875em;">remains true even in this era of almost everything running on solid-state drives. As &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:42.3909em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0075em;">the size of your data grows and your queries need to scan more of it to fulfill requests, &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:43.4409em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0008em;">you will find that I/O wait can become a bottleneck for your traffic growth. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:44.9909em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.1216em;">Monitoring your disk I/O activity helps you get ahead of performance degradation &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:46.0409em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0093em;">before it becomes customer facing. There are a few things you can monitor to achieve &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:47.0796em;z-index:2287;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1083em;">this goal. </span><span class="stl_154 stl_32 stl_105">T</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1083em;">ols like </span><span class="stl_155 stl_41 stl_248" style="word-spacing:0.1271em;">iostat </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1083em;">can help you monitor for I/O wait. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_36" style="word-spacing:0.1121em;">u want to monitor &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">32 &nbsp;</span></div>
					<div class="stl_01" style="left:7.3623em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:8.2698em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Chapter 2: Monitoring in a Reliability Engineering World &nbsp;</span></div>
					<a name="54_0" style="position:absolute;left:0em;top:32.6702em;">&nbsp;</a>
					<a name="54_1" style="position:absolute;left:0em;top:47.3202em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>