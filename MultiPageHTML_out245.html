<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_261.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_261.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:6em;top:4.3052em;z-index:15;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1239em;">as </span><span class="stl_155 stl_41 stl_103">memcached</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1239em;">. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_74" style="word-spacing:0.1255em;">u’ll probably find yourself faced with the familiar dilemma, “fast, &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:5.3666em;z-index:104;"><span class="stl_154 stl_32 stl_138" style="word-spacing:0.0075em;">accurate, and simple: pick any two</span><span class="stl_154 stl_32 stl_161">.</span><span class="stl_154 stl_32 stl_161">” &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:7.2509em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Optimizing JOIN Queries &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:9.1507em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.1157em;">This topic is actually spread throughout most of the book, but we’ll mention a few &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:10.2007em;"><span class="stl_154 stl_32 stl_36">highlights: &nbsp;</span></div>
					<div class="stl_01" style="left:6.7212em;top:12.1334em;"><span class="stl_154 stl_32 stl_152" style="word-spacing:0.2841em;">• Make</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0333em;">&nbsp;</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0277em;">sure there are indexes on the columns in the </span><span class="stl_170 stl_171 stl_28">O</span><span class="stl_170 stl_171 stl_369">N</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0275em;">or </span><span class="stl_170 stl_171 stl_28">USIN</span><span class="stl_170 stl_171 stl_369">G</span><span class="stl_154 stl_32 stl_35" style="word-spacing:0.0027em;">clauses. Consider &nbsp;</span></div>
					<div class="stl_01" style="left:7.5em;top:13.2329em;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.0419em;">the join order when adding indexes. If you’re joining tables </span><span class="stl_170 stl_171 stl_374">A</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.038em;">and </span><span class="stl_170 stl_171 stl_374">B</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.038em;">on column </span><span class="stl_170 stl_171 stl_28" style="word-spacing:0.04em;">c &nbsp;</span></div>
					<div class="stl_01" style="left:7.5004em;top:14.3323em;"><span class="stl_154 stl_32 stl_188" style="word-spacing:0.1348em;">and the query optimizer decides to join the tables in the order </span><span class="stl_170 stl_171 stl_28">B</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1363em;">, </span><span class="stl_170 stl_171 stl_28">A</span><span class="stl_154 stl_32 stl_390" style="word-spacing:0.175em;">, you don’t &nbsp;</span></div>
					<div class="stl_01" style="left:7.4999em;top:15.4318em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0299em;">need to index the column on table </span><span class="stl_170 stl_171 stl_28">B</span><span class="stl_154 stl_32 stl_33" style="word-spacing:0.0342em;">. Unused indexes are extra overhead. In gen‐ &nbsp;</span></div>
					<div class="stl_01" style="left:7.5003em;top:16.4818em;"><span class="stl_154 stl_32 stl_46" style="word-spacing:0.0921em;">eral, you need to add indexes only on the second table in the join order, unless &nbsp;</span></div>
					<div class="stl_01" style="left:7.4998em;top:17.5318em;"><span class="stl_154 stl_32 stl_54" style="word-spacing:0.0041em;">they’re needed for some other reason. &nbsp;</span></div>
					<div class="stl_01" style="left:6.7213em;top:18.9645em;z-index:564;"><span class="stl_154 stl_32 stl_196" style="word-spacing:0.4387em;">• T</span><span class="stl_154 stl_32 stl_413">r</span><span class="stl_154 stl_32 stl_28">y</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0677em;">&nbsp;</span><span class="stl_154 stl_32 stl_55" style="word-spacing:0.0754em;">to ensure that any </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.061em;">GROUP BY </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0677em;">or </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.061em;">ORDER BY </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0677em;">expression refers only to columns &nbsp;</span></div>
					<div class="stl_01" style="left:7.5001em;top:20.0145em;"><span class="stl_154 stl_32 stl_95" style="word-spacing:0.0019em;">from a single table, so MySQL can try to use an index for that operation. &nbsp;</span></div>
					<div class="stl_01" style="left:6.7216em;top:21.3979em;"><span class="stl_154 stl_32 stl_253" style="word-spacing:0.2323em;">• Be</span><span class="stl_154 stl_32 stl_28" style="word-spacing:-0.0002em;">&nbsp;</span><span class="stl_154 stl_32 stl_77" style="word-spacing:0.0231em;">careful when upgrading MySQL because the join syntax, operator precedence, &nbsp;</span></div>
					<div class="stl_01" style="left:7.5001em;top:22.4479em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.1257em;">and other behaviors have changed at various times. What used to be a normal &nbsp;</span></div>
					<div class="stl_01" style="left:7.4996em;top:23.4979em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.0576em;">join can sometimes become a cross product, a different kind of join that returns &nbsp;</span></div>
					<div class="stl_01" style="left:7.5em;top:24.5479em;"><span class="stl_154 stl_32 stl_54" style="word-spacing:0.0039em;">different results, or even invalid syntax. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:26.4322em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Optimizing GROUP BY with ROLLUP &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:28.332em;"><span class="stl_154 stl_32 stl_46" style="word-spacing:0.0781em;">A variation on grouped queries is to ask MySQL to do super aggregation within the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:29.4314em;z-index:1022;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0742em;">results. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0742em;">u can do this with a </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0544em;">WITH ROLLUP </span><span class="stl_154 stl_32 stl_77" style="word-spacing:0.0774em;">clause, but it might not be as well opti‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:30.5308em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1124em;">mized as you need. Check the execution method with </span><span class="stl_170 stl_171 stl_28">EXPLAIN</span><span class="stl_154 stl_32 stl_162" style="word-spacing:0.1204em;">, paying attention to &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:31.6303em;"><span class="stl_154 stl_32 stl_188" style="word-spacing:0.0773em;">whether the grouping is done via filesort or temporary table; try removing the </span><span class="stl_170 stl_171 stl_28">WITH &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:32.7297em;z-index:1258;"><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.1194em;">ROLLUP </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1346em;">and see if you get the same group method. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_46" style="word-spacing:0.1371em;">u might be able to force the &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:33.7797em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.0016em;">grouping method with the hints we mentioned earlier in this section. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:35.3297em;z-index:1351;"><span class="stl_154 stl_32 stl_24" style="word-spacing:0.1123em;">Sometimes it</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1069em;">s </span><span class="stl_154 stl_32 stl_28">m</span><span class="stl_154 stl_32 stl_39" style="word-spacing:0.1102em;">ore efficient to do super aggregation in your application, even if it &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:36.3797em;z-index:1451;"><span class="stl_154 stl_32 stl_48" style="word-spacing:0.0315em;">means fetching many more rows from the server. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_137" style="word-spacing:0.0246em;">u can also nest a subquery in the &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:37.4791em;"><span class="stl_170 stl_171 stl_28">FRO</span><span class="stl_170 stl_171 stl_464">M</span><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0522em;">clause or use a temporary table to hold intermediate results and then query the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:38.5786em;"><span class="stl_154 stl_32 stl_188" style="word-spacing:-0.0013em;">temporary table with a </span><span class="stl_170 stl_171 stl_28">UNION</span><span class="stl_154 stl_32 stl_28">. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:40.178em;"><span class="stl_154 stl_32 stl_39" style="word-spacing:0.0673em;">The best approach might be to move the </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0648em;">WITH ROLLUP </span><span class="stl_154 stl_32 stl_39" style="word-spacing:0.0673em;">functionality into your appli‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:41.228em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.0042em;">cation code. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9995em;top:43.1123em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Optimizing LIMIT and OFFSET &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:45.0615em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0636em;">Queries with </span><span class="stl_170 stl_171 stl_28">LIMIT</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0631em;">s and </span><span class="stl_170 stl_171 stl_28">OFFSET</span><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0654em;">s are common in systems that do pagination, nearly &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:46.161em;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.0357em;">always in conjunction with an </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0979em;">ORDER BY </span><span class="stl_154 stl_32 stl_101" style="word-spacing:0.0465em;">clause. It’s helpful to have an index that sup‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:47.211em;"><span class="stl_154 stl_32 stl_178" style="word-spacing:-0.0025em;">ports the ordering; otherwise, the server has to do a lot of filesorts. &nbsp;</span></div>
					<div class="stl_01" style="left:24.6005em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Optimizing </span><span class="stl_233 stl_27 stl_28" style="word-spacing:-0.092em;">Speciﬁc </span><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Types of Queries &nbsp;</span></div>
					<div class="stl_01" style="left:34.1743em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:35.0818em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">223 &nbsp;</span></div>
					<a name="245_0" style="position:absolute;left:0em;top:7.544em;">&nbsp;</a>
					<a name="245_1" style="position:absolute;left:0em;top:26.7252em;">&nbsp;</a>
					<a name="245_2" style="position:absolute;left:0em;top:43.4054em;">&nbsp;</a>
					<a name="245_3" style="position:absolute;left:0em;top:28.5612em;">&nbsp;</a>
					<a name="245_4" style="position:absolute;left:0em;top:9.3799em;">&nbsp;</a>
					<a name="245_5" style="position:absolute;left:0em;top:45.2908em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>