<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_114.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_114.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:6em;top:4.3166em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.2111em;">the only way to find subtle misconfigurations or sneaky hard drive behaviors. A &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:5.3666em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">handy script for this can be found </span><a href="https://oreil.ly/2Lume" target="_blank"><span class="stl_184 stl_32 stl_28">online</span></a><span class="stl_154 stl_32 stl_28">. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:6.9166em;z-index:209;"><span class="stl_154 stl_32 stl_105" style="word-spacing:0.3103em;">To </span><span class="stl_154 stl_32 stl_28">t</span><span class="stl_154 stl_32 stl_88" style="word-spacing:0.1153em;">est whether you can really rely on your RAID controller</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1143em;">s </span><span class="stl_154 stl_32 stl_28">B</span><span class="stl_154 stl_32 stl_45" style="word-spacing:0.1327em;">BU, make sure you &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:7.9666em;"><span class="stl_154 stl_32 stl_120" style="word-spacing:0.0726em;">leave the power cord unplugged for a realistic amount of time. Some units don’t last &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:9.0166em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.1211em;">as long without power as they’re supposed to. Here again, one bad link can render &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:10.0666em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0022em;">your whole chain of storage components useless. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:11.9631em;"><span class="stl_159 stl_27 stl_28" style="word-spacing:0em;">Network </span><span class="stl_160 stl_27 stl_28">Conﬁguration &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:14.2333em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.0192em;">Just as latency and throughput are limiting factors for a hard drive, latency and band‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:15.2833em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1199em;">width are limiting factors for a network connection. The biggest problem for most &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:16.3333em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0301em;">applications is latency; a typical application does a lot of small network transfers, and &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:17.3833em;"><span class="stl_154 stl_32 stl_38" style="word-spacing:0.0047em;">the slight delay for each transfer adds up. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:18.9333em;"><span class="stl_154 stl_32 stl_43" style="word-spacing:0.2289em;">A network that’s not operating correctly is a major performance bottleneck, too. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:19.9833em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.0218em;">Packet loss is a common problem. Even 1% loss is enough to cause significant perfor‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:21.0333em;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.176em;">mance degradation because various layers in the protocol stack will try to fix the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:22.0833em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0927em;">problems with strategies such as waiting a while and then resending packets, which &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:23.1333em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">adds extra time. Another common problem is broken or slow DNS resolution.</span><sup style="top: -0.2917em;"><a href="MultiPageHTML_out108.html#108_1"><span class="stl_166 stl_32 stl_28" style="word-spacing:0em;">1 &nbsp;</span></a></sup></div>
					<div class="stl_01" style="left:5.9996em;top:24.7327em;"><span class="stl_154 stl_32 stl_143" style="word-spacing:0.0895em;">DNS is enough of an Achilles’ heel that enabling </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.1728em;">skip_name_resolve </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0838em;">is a good idea &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:25.7827em;"><span class="stl_154 stl_32 stl_37" style="word-spacing:0.0317em;">for production servers. Broken or slow DNS resolution is a problem for lots of appli‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:26.8327em;"><span class="stl_154 stl_32 stl_124" style="word-spacing:0.1053em;">cations, but it’s particularly severe for MySQL. When MySQL receives a connection &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:27.8827em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.076em;">request, it does both a forward and a reverse DNS lookup. There are lots of reasons &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:28.9327em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0284em;">this could go wrong. When it does, it will cause connections to be denied, slow down &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:29.9827em;"><span class="stl_154 stl_32 stl_95" style="word-spacing:0.0343em;">the process of connecting to the server, and generally wreak havoc, up to and includ‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:31.0822em;"><span class="stl_154 stl_32 stl_126" style="word-spacing:0.1314em;">ing denial-of-service attacks. If you enable the </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.1221em;">skip_name_resolve </span><span class="stl_154 stl_32 stl_99" style="word-spacing:0.1384em;">option, MySQL &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:32.1322em;"><span class="stl_154 stl_32 stl_25" style="word-spacing:0.109em;">won’t do any DNS lookups at all. However, this also means that your user accounts &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:33.2316em;z-index:1606;"><span class="stl_154 stl_32 stl_46" style="word-spacing:0.0276em;">must have only IP addresses, “localhost</span><span class="stl_154 stl_32 stl_161">,</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0251em;">” or IP address wildcards in the </span><span class="stl_170 stl_171 stl_28">hos</span><span class="stl_170 stl_171 stl_329">t</span><span class="stl_154 stl_32 stl_28">column. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:34.331em;"><span class="stl_154 stl_32 stl_84" style="word-spacing:0.0047em;">Any user account that has a hostname in the </span><span class="stl_170 stl_171 stl_28">hos</span><span class="stl_170 stl_171 stl_186">t</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">column will not be able to log in. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:35.881em;"><span class="stl_154 stl_32 stl_43" style="word-spacing:0.0929em;">It’s usually more important, though, to adjust your settings to deal efficiently with a &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:36.931em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0747em;">lot of connections and small queries. One of the more common tweaks is to change &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:37.981em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.1502em;">your local port range. Linux systems have a range of local ports that can be used. &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:39.031em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.0717em;">When the connection is made back to a caller, it uses a local port. If you have many &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:40.081em;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.0009em;">simultaneous connections, you can run out of local ports. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:41.631em;"><span class="stl_154 stl_32 stl_144" style="word-spacing:0.012em;">Here’s a system that is configured to default values: &nbsp;</span></div>
					<div class="stl_01" style="left:7.4168em;top:43.3929em;"><span class="stl_200 stl_171 stl_28">$ </span><span class="stl_265 stl_173 stl_28">cat /proc/sys/net/ipv4/ip_local_port_range &nbsp;</span></div>
					<div class="stl_01" style="left:7.4168em;top:44.2436em;"><span class="stl_200 stl_171 stl_28">32768 61000 &nbsp;</span></div>
					<div class="stl_01" style="left:6.095em;top:48.2703em;"><span class="stl_167 stl_32 stl_28">1</span></div>
					<div class="stl_01" style="left:6.6667em;top:48.1878em;"><span class="stl_168 stl_32 stl_330" style="word-spacing:0.0263em;">Popular haiku: It’s not DNS. There’s no way it’s DNS. It was DNS. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">86 &nbsp;</span></div>
					<div class="stl_01" style="left:7.3617em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:8.2692em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Chapter 4: Operating System and Hardware Optimization &nbsp;</span></div>
					<a name="108_0" style="position:absolute;left:0em;top:12.3147em;">&nbsp;</a>
					<a name="108_1" style="position:absolute;left:0em;top:48.2792em;">&nbsp;</a>
					<a name="108_2" style="position:absolute;left:0em;top:23.3625em;">&nbsp;</a>
					<a name="108_3" style="position:absolute;left:0em;top:14.4625em;">&nbsp;</a>
					<a name="108_4" style="position:absolute;left:0em;top:10.2958em;">&nbsp;</a>
					<a name="108_5" style="position:absolute;left:0em;top:20.2125em;">&nbsp;</a>
					<a name="108_6" style="position:absolute;left:0em;top:24.962em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>