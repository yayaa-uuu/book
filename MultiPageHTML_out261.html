<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_280.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_280.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:6em;top:4.3166em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.1226em;">only if you really need them because they make it so easy to break replication and &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:5.3666em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.2107em;">cause problems that will manifest when least convenient, such as during disaster &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:6.4166em;z-index:146;"><span class="stl_154 stl_32 stl_25">recovery. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:7.9666em;"><span class="stl_154 stl_32 stl_95" style="word-spacing:0.0017em;">That being said, there can be specific situations where replication filters are beneficial. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:9.066em;"><span class="stl_154 stl_32 stl_138" style="word-spacing:0.0124em;">Perhaps you created multiple databases </span><span class="stl_170 stl_171 stl_28">users_1</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0047em;">, </span><span class="stl_170 stl_171 stl_28">users_2</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0047em;">, </span><span class="stl_170 stl_171 stl_28">users_3</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0052em;">, and </span><span class="stl_170 stl_171 stl_28">users_4</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">, and &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:10.116em;"><span class="stl_154 stl_32 stl_87" style="word-spacing:0.0641em;">now performance on your server is too impacted. By restoring a backup and attach‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:11.2155em;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.1681em;">ing replication, you can prepare to move the queries for </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0852em;">users_3 </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1671em;">and </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0852em;">users_4 </span><span class="stl_154 stl_32 stl_28">to &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:12.3149em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.2188em;">another server. This works perfectly fine, except that you still have </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.034em;">users_1 </span><span class="stl_154 stl_32 stl_28">and &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:13.4143em;"><span class="stl_170 stl_171 stl_28">users_</span><span class="stl_170 stl_171 stl_474">2</span><span class="stl_154 stl_32 stl_43" style="word-spacing:0.0633em;">on your new database. At some point, you’ll have to drop the data that may &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:14.4643em;z-index:616;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.201em;">be affecting performance. Consider this alternative. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.2001em;">u restore your backup and &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:15.5638em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1856em;">then drop </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0657em;">users_1 </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1856em;">and </span><span class="stl_170 stl_171 stl_28">users_2</span><span class="stl_154 stl_32 stl_53" style="word-spacing:0.1867em;">. Then you configure a replication rule to ignore &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:16.6632em;"><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.091em;">users_1 </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1616em;">and </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.091em;">users_2 </span><span class="stl_154 stl_32 stl_162" style="word-spacing:0.1695em;">and complete replication setup. Now you’re only processing &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:17.7627em;"><span class="stl_154 stl_32 stl_24" style="word-spacing:0.0411em;">events for </span><span class="stl_170 stl_171 stl_28">users_</span><span class="stl_170 stl_171 stl_249">3</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0357em;">and </span><span class="stl_170 stl_171 stl_28">users_</span><span class="stl_170 stl_171 stl_249">4</span><span class="stl_154 stl_32 stl_183" style="word-spacing:0.0451em;">on your new server. Once you’re caught up on repli‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:18.8127em;"><span class="stl_154 stl_32 stl_71" style="word-spacing:0.0058em;">cation, you’re good to take production traffic. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:20.3627em;"><span class="stl_154 stl_32 stl_55" style="word-spacing:0.0577em;">The filtering options are well documented in the MySQL manual, so we won’t repeat &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:21.4127em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">the details here. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:23.3092em;"><span class="stl_159 stl_27 stl_28" style="word-spacing:0em;">Replication Failover &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:25.5794em;"><span class="stl_154 stl_32 stl_99" style="word-spacing:0.082em;">At the beginning of the chapter, we mentioned that replication is the cornerstone of &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:26.6294em;"><span class="stl_154 stl_32 stl_99" style="word-spacing:0.0389em;">high availability, among other things. Having a copy of your data continuously upda‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:27.6794em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0547em;">ted in another location makes it much easier to recover from catastrophe than going &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:28.7294em;"><span class="stl_154 stl_32 stl_72" style="word-spacing:0.0919em;">to backup. More than that, there will be times you simply need to do some mainte‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:29.7794em;"><span class="stl_154 stl_32 stl_123" style="word-spacing:0.0053em;">nance that involves restarting MySQL. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:31.3294em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0698em;">In this section, we want to talk about the right ways to promote a replica to become &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:32.3794em;"><span class="stl_154 stl_32 stl_124" style="word-spacing:0.1068em;">the source node. It’s easy to get wrong, and getting it wrong can lead to data issues &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:33.4294em;z-index:1453;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.1162em;">and extended downtime. </span><span class="stl_154 stl_32 stl_52">W</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.114em;">e </span><span class="stl_154 stl_32 stl_28">w</span><span class="stl_154 stl_32 stl_107" style="word-spacing:0.123em;">ant to clarify that “promoting a replica” and “failing &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:34.4794em;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.139em;">over” are synonymous. They both mean the act of demoting a source from taking &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:35.5294em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">writes and promoting a replica to the source role. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:37.0794em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.1479em;">A much more detailed explanation of how to handle this is in the official MySQL &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:38.1294em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.1849em;">documentation, under the “Switching Sources During Failover” section, but given &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:39.1794em;"><span class="stl_154 stl_32 stl_84" style="word-spacing:0.0047em;">how important this is to get right, we wanted to touch on it at least at some level. &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:41.0637em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Planned Promotions &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:42.9634em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.2331em;">The most common reason for a promotion is some kind of maintenance event, &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:44.0134em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0365em;">including security patching, kernel updates, and even just restarting MySQL, as there &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:45.0634em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.2122em;">are a few configuration options that require a restart. This type of promotion is &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:46.1021em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">referred to as a </span><span class="stl_155 stl_41 stl_202" style="word-spacing:0.0184em;">controlled </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">or </span><span class="stl_155 stl_41 stl_59" style="word-spacing:0.0188em;">planned promotion</span><span class="stl_154 stl_32 stl_59" style="word-spacing:0.0188em;">. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:47.6634em;"><span class="stl_154 stl_32 stl_105" style="word-spacing:0.196em;">To </span><span class="stl_154 stl_32 stl_28">p</span><span class="stl_154 stl_32 stl_36" style="word-spacing:0.0038em;">erform this promotion successfully, you want to accomplish the following steps: &nbsp;</span></div>
					<div class="stl_01" style="left:28.5405em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Replication Failover &nbsp;</span></div>
					<div class="stl_01" style="left:34.1745em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:35.082em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">239 &nbsp;</span></div>
					<a name="261_0" style="position:absolute;left:0em;top:23.6608em;">&nbsp;</a>
					<a name="261_1" style="position:absolute;left:0em;top:41.3567em;">&nbsp;</a>
					<a name="261_2" style="position:absolute;left:0em;top:43.1927em;">&nbsp;</a>
					<a name="261_3" style="position:absolute;left:0em;top:25.8086em;">&nbsp;</a>
					<a name="261_4" style="position:absolute;left:0em;top:21.6419em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>