<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_330.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_330.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:6em;top:4.3166em;z-index:71;"><span class="stl_154 stl_32 stl_52" style="word-spacing:0.194em;">We </span><span class="stl_154 stl_32 stl_28">d</span><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0008em;">emonstrate how to do each of these steps as needed in the following sections. </span><span class="stl_154 stl_32 stl_52">W</span><span class="stl_154 stl_32 stl_52">e &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:5.3666em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1411em;">also add notes specific to certain backup methods or tools in sections about those &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:6.4166em;z-index:173;"><span class="stl_154 stl_32 stl_51" style="word-spacing:0.0078em;">methods or tools later in this chapter. &nbsp;</span></div>
					<div class="stl_01" style="left:11.3993em;top:8.7287em;"><span class="stl_176 stl_32 stl_148" style="word-spacing:0.1849em;">If there’s a chance you’ll need the current versions of your files, &nbsp;</span></div>
					<div class="stl_01" style="left:11.3993em;top:9.6783em;"><span class="stl_372 stl_41 stl_414" style="word-spacing:0.1846em;">don’t replace them with the </span><span class="stl_492 stl_41 stl_28" style="word-spacing:0.1402em;">ﬁles </span><span class="stl_372 stl_41 stl_192" style="word-spacing:0.177em;">from the backup</span><span class="stl_176 stl_32 stl_55" style="word-spacing:0.1688em;">. For example, if &nbsp;</span></div>
					<div class="stl_01" style="left:11.3994em;top:10.6487em;"><span class="stl_176 stl_32 stl_112" style="word-spacing:0.0035em;">your backup includes the binary logs and you need to replay binary &nbsp;</span></div>
					<div class="stl_01" style="left:11.3994em;top:11.6087em;"><span class="stl_176 stl_32 stl_143" style="word-spacing:0.0821em;">logs for point-in-time recovery, don’t overwrite the current binary &nbsp;</span></div>
					<div class="stl_01" style="left:11.3994em;top:12.5687em;"><span class="stl_176 stl_32 stl_74" style="word-spacing:0.1915em;">logs with older copies from the backup. Rename them or move &nbsp;</span></div>
					<div class="stl_01" style="left:11.3995em;top:13.5287em;z-index:471;"><span class="stl_176 stl_32 stl_33" style="word-spacing:0.0042em;">them elsewhere if necessary. &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:15.7266em;"><span class="stl_154 stl_32 stl_43" style="word-spacing:0.2472em;">During recovery, it’s often important to make MySQL inaccessible to everything &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:16.826em;z-index:566;"><span class="stl_154 stl_32 stl_106" style="word-spacing:0.1528em;">except the recovery process. </span><span class="stl_154 stl_32 stl_52">W</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1555em;">e </span><span class="stl_154 stl_32 stl_28">l</span><span class="stl_154 stl_32 stl_54" style="word-spacing:0.1595em;">ike to start MySQL with the </span><span class="stl_170 stl_171 stl_28">--skip-networking &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:17.9255em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0981em;">and </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.1578em;">--socket=/tmp/mysql_recover.sock </span><span class="stl_154 stl_32 stl_46" style="word-spacing:0.1007em;">options to ensure that it is unavailable to &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:18.9755em;"><span class="stl_154 stl_32 stl_143" style="word-spacing:0.0891em;">existing applications until we’ve checked it and brought it back online. This is espe‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:20.0255em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.0017em;">cially important for logical backups, which are loaded in pieces. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0006em;top:21.9098em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Restoring Logical Backups &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:23.8096em;"><span class="stl_154 stl_32 stl_38" style="word-spacing:0.1188em;">If you’re restoring logical backups instead of raw files, you need to use the MySQL &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:24.8596em;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.0981em;">server itself to load the data back into the tables, as opposed to using the operating &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:25.9096em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.0029em;">system to simply copy files into place. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:27.4596em;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.0796em;">Before you load that dump file, however, take a moment to consider how large it is, &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:28.5096em;"><span class="stl_154 stl_32 stl_46" style="word-spacing:0.0507em;">how long it’ll take to load, and anything you might want to do before you start, such &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:29.5596em;"><span class="stl_154 stl_32 stl_117" style="word-spacing:0.0122em;">as notifying your users or disabling part of your application. Disabling binary logging &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:30.6096em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.0424em;">might be a good idea, unless you need to replicate the restoration to a replica: a huge &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:31.6596em;"><span class="stl_154 stl_32 stl_227" style="word-spacing:0.0469em;">dump file is hard enough for the server to load, and writing it to the binary log adds &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:32.7096em;"><span class="stl_154 stl_32 stl_37" style="word-spacing:0.2843em;">even more (possibly unnecessary) overhead. Loading huge files also has conse‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:33.7596em;z-index:1465;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.0286em;">quences for some storage engines. For example, it</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0249em;">s </span><span class="stl_154 stl_32 stl_28">n</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0249em;">ot a good idea to load 100 GB of &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:34.8096em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.1117em;">data into InnoDB in a single transaction because of the huge rollback segment that &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:35.8596em;z-index:1572;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0735em;">will result. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0743em;">u should load in manageable chunks and commit the transaction after &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:36.9096em;"><span class="stl_154 stl_32 stl_38" style="word-spacing:0.0047em;">each chunk. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:38.4596em;"><span class="stl_154 stl_32 stl_46" style="word-spacing:0.0506em;">There are two kinds of restoration you might do, which correspond to the two kinds &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:39.5096em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">of logical backups you can make. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:41.0596em;"><span class="stl_154 stl_32 stl_48" style="word-spacing:0.0849em;">If you have a SQL dump, the file will contain executable SQL. All you need to do is &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:42.1096em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0265em;">run it. Assuming you backed up the Sakila Sample Database and schema into a single &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:43.1596em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0009em;">file, the following is a typical command you might use to restore it: &nbsp;</span></div>
					<div class="stl_01" style="left:7.4169em;top:44.9214em;"><span class="stl_200 stl_171 stl_28">$ </span><span class="stl_265 stl_173 stl_28" style="word-spacing:0em;">mysql &lt; sakila-backup.sql &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:46.0976em;z-index:1951;"><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0111em;">u can also load the file from within the </span><span class="stl_155 stl_41 stl_25" style="word-spacing:0.02em;">mysql </span><span class="stl_154 stl_32 stl_95" style="word-spacing:0.0129em;">command-line client with the </span><span class="stl_170 stl_171 stl_28">SOURCE &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:47.159em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.0579em;">command. Although this is mostly a different way of doing the same thing, it makes &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">282 &nbsp;</span></div>
					<div class="stl_01" style="left:7.6684em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:8.5759em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Chapter 10: Backup and Recovery &nbsp;</span></div>
					<a name="304_0" style="position:absolute;left:0em;top:22.2028em;">&nbsp;</a>
					<a name="304_1" style="position:absolute;left:0em;top:24.0388em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>