<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_31.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_31.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:6em;top:4.1653em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Read/Write Locks &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:6.065em;"><span class="stl_154 stl_32 stl_150" style="word-spacing:0.0616em;">Reading from the spreadsheet isn’t as troublesome. There’s nothing wrong with mul‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:7.115em;"><span class="stl_154 stl_32 stl_72" style="word-spacing:0.0085em;">tiple clients reading the same file simultaneously; because they aren’t making changes, &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:8.165em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0987em;">nothing is likely to go wrong. What happens if someone tries to delete cell number &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:9.2645em;"><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.127em;">A25 </span><span class="stl_154 stl_32 stl_78" style="word-spacing:0.1289em;">while others are reading the spreadsheet? It depends, but a reader could come &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:10.3145em;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.1047em;">away with a corrupted or inconsistent view of the data. So, to be safe, even reading &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:11.3645em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">from a spreadsheet requires special care. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:12.9145em;z-index:451;"><span class="stl_154 stl_32 stl_46" style="word-spacing:0.055em;">If you think of the spreadsheet as a database table, it</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0523em;">s </span><span class="stl_154 stl_32 stl_28">e</span><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0546em;">asy to see that the problem is &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:13.9645em;"><span class="stl_154 stl_32 stl_48" style="word-spacing:0.0597em;">the same in this context. In many ways, a spreadsheet is really just a simple database &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:15.0145em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0345em;">table. Modifying rows in a database table is very similar to removing or changing the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:16.0645em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.0029em;">content of cells in a spreadsheet file. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:17.6145em;"><span class="stl_154 stl_32 stl_95" style="word-spacing:0.05em;">The solution to this classic problem of concurrency control is rather simple. Systems &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:18.6645em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.0323em;">that deal with concurrent read/write access typically implement a locking system that &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:19.7031em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0127em;">consists of two lock types. These locks are usually known as </span><span class="stl_155 stl_41 stl_190" style="word-spacing:0.0295em;">shared locks </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.013em;">and </span><span class="stl_155 stl_41 stl_129">exclusive &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:20.7531em;"><span class="stl_155 stl_41 stl_162">locks</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">, or read locks and write locks. &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:22.3145em;"><span class="stl_154 stl_32 stl_87" style="word-spacing:0.0606em;">Without worrying about the actual locking mechanism, we can describe the concept &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:23.3531em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0932em;">as follows. </span><span class="stl_155 stl_41 stl_139" style="word-spacing:0.1025em;">Read locks </span><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0953em;">on a resource are shared, or mutually nonblocking: many cli‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:24.4145em;z-index:1108;"><span class="stl_154 stl_32 stl_38" style="word-spacing:0.1054em;">ents can read from a resource at the same time and not interfere with one another. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:25.4531em;"><span class="stl_155 stl_41 stl_191" style="word-spacing:0.0773em;">Write locks</span><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0534em;">, on the other hand, are exclusive—that is, they block both read locks and &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:26.5145em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0261em;">other write locks—because the only safe policy is to have a single client writing to the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:27.5645em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0025em;">resource at a given time and to prevent all reads when a client is writing. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:29.1145em;"><span class="stl_154 stl_32 stl_54" style="word-spacing:0.035em;">In the database world, locking happens all the time: MySQL has to prevent one client &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:30.1645em;"><span class="stl_154 stl_32 stl_87" style="word-spacing:0.0575em;">from reading a piece of data while another is changing it. If a database server is per‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:31.2145em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.0631em;">forming in an acceptable manner, this management of locks is fast enough to not be &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:32.2645em;z-index:1547;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.1232em;">noticeable to the clients. </span><span class="stl_154 stl_32 stl_52">W</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1212em;">e </span><span class="stl_154 stl_32 stl_28">w</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1212em;">ill discuss in </span><a href="MultiPageHTML_out213.html#213_0"><span class="stl_184 stl_32 stl_99" style="word-spacing:0.1275em;">Chapter 8 </span></a><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1212em;">how to tune your queries to &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:33.3145em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0023em;">avoid performance issues caused by locking. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:35.1988em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Lock Granularity &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:37.0986em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.1557em;">One way to improve the concurrency of a shared resource is to be more selective &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:38.1486em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0608em;">about what you lock. Rather than locking the entire resource, lock only the part that &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:39.1986em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.0207em;">contains the data you need to change. Better yet, lock only the exact piece of data you &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:40.2486em;"><span class="stl_154 stl_32 stl_54" style="word-spacing:0.14em;">plan to change. Minimizing the amount of data that you lock at any one time lets &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:41.2986em;"><span class="stl_154 stl_32 stl_43" style="word-spacing:0.0755em;">changes to a given resource occur simultaneously, as long as they don’t conflict with &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:42.3486em;z-index:1997;"><span class="stl_154 stl_32 stl_192" style="word-spacing:0.0157em;">each other. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:43.8986em;"><span class="stl_154 stl_32 stl_38" style="word-spacing:0.138em;">Unfortunately, locks are not free—they consume resources. Every lock operation— &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:44.9486em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0313em;">getting a lock, checking to see whether a lock is free, releasing a lock, and so on—has &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:45.9986em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0393em;">overhead. If the system spends too much time managing locks instead of storing and &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:47.0486em;z-index:2243;"><span class="stl_154 stl_32 stl_123" style="word-spacing:0.0053em;">retrieving data, performance can suffer. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">4</span></div>
					<div class="stl_01" style="left:7.0563em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:7.9638em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Chapter 1: MySQL Architecture &nbsp;</span></div>
					<a name="26_0" style="position:absolute;left:0em;top:4.4583em;">&nbsp;</a>
					<a name="26_1" style="position:absolute;left:0em;top:35.4919em;">&nbsp;</a>
					<a name="26_2" style="position:absolute;left:0em;top:37.3278em;">&nbsp;</a>
					<a name="26_3" style="position:absolute;left:0em;top:6.2943em;">&nbsp;</a>
					<a name="26_4" style="position:absolute;left:0em;top:19.9437em;">&nbsp;</a>
					<a name="26_5" style="position:absolute;left:0em;top:25.6937em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>