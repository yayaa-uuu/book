<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_56.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_56.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:6em;top:4.3166em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.0192em;">Remote validation of availability is useful for tracking an availability objective. It does &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:5.3552em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.1506em;">not help you gain insight </span><span class="stl_155 stl_41 stl_76" style="word-spacing:0.1634em;">before </span><span class="stl_154 stl_32 stl_48" style="word-spacing:0.1517em;">a problem arises. One MySQL metric that can be &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:6.4166em;"><span class="stl_154 stl_32 stl_54" style="word-spacing:0.3114em;">used as a leading indicator for availability issues is the MySQL status counter &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:7.516em;"><span class="stl_170 stl_171 stl_28">Threads_running</span><span class="stl_154 stl_32 stl_143" style="word-spacing:0.0495em;">. It tracks how many queries are currently in flight on a given data‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:8.566em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0113em;">base host. When threads running are growing at a fast rate and not showing any signs &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:9.616em;"><span class="stl_154 stl_32 stl_53" style="word-spacing:0.0043em;">of decline, that indicates queries are not finishing fast enough and are therefore stack‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:10.666em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0527em;">ing and consuming resources. Allowing this metric to grow usually results in a data‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:11.716em;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.0851em;">base host causing either a full CPU lockup or intense memory load that can lead to &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:12.766em;"><span class="stl_154 stl_32 stl_77" style="word-spacing:0.015em;">the entire MySQL process being shut down by the operating system. This is obviously &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:13.816em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.1204em;">a major outage if it happens on a source node and something you should strive to &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:14.866em;"><span class="stl_154 stl_32 stl_123" style="word-spacing:0.0904em;">have leading indicators for. A starting point to monitor this is to inspect how many &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:15.9655em;"><span class="stl_154 stl_32 stl_83" style="word-spacing:0.0076em;">CPU cores you have and, if </span><span class="stl_170 stl_171 stl_28">Threads_runnin</span><span class="stl_170 stl_171 stl_199">g</span><span class="stl_154 stl_32 stl_84" style="word-spacing:0.0099em;">is exceeding that, that can be a sign that &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:17.0155em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.0232em;">your server is hitting that precarious state. In conjunction with that, you can monitor &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:18.1149em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0158em;">how close you get to </span><span class="stl_170 stl_171 stl_28">max_connection</span><span class="stl_170 stl_171 stl_241">s</span><span class="stl_154 stl_32 stl_46" style="word-spacing:0.0184em;">as another data point to check for an overload &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:19.1649em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">of work in progress. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:20.7149em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0201em;">The section </span><a href="MultiPageHTML_out142.html#142_0"><span class="stl_184 stl_32 stl_222" style="word-spacing:0.0268em;">“Safety Settings” on page 120 </span></a><span class="stl_154 stl_32 stl_28" style="word-spacing:0.02em;">in </span><a href="MultiPageHTML_out121.html#121_0"><span class="stl_184 stl_32 stl_99" style="word-spacing:0.0263em;">Chapter 5 </span></a><span class="stl_154 stl_32 stl_54" style="word-spacing:0.0241em;">gives insight into how you can &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:21.7649em;"><span class="stl_154 stl_32 stl_114" style="word-spacing:0.005em;">set the brakes on runaway MySQL threads. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:23.6492em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Monitoring Query Latency &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:25.549em;"><span class="stl_154 stl_32 stl_132" style="word-spacing:0.1319em;">MySQL has introduced a number of </span><a href="https://oreil.ly/h9cDB" target="_blank"><span class="stl_184 stl_32 stl_53" style="word-spacing:0.1265em;">long-needed enhancements to track how long &nbsp;</span></a></div>
					<div class="stl_01" style="left:5.9997em;top:26.599em;"><a href="https://oreil.ly/h9cDB" target="_blank"><span class="stl_184 stl_32 stl_28" style="word-spacing:0.1602em;">queries take to run</span></a><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1602em;">, and you should definitely use your monitoring stack to track &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:27.649em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.0565em;">these trends as your application code changes. However, this is still not a full picture &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:28.699em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.1873em;">of the customer experience, especially given how modern software architecture is &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:29.749em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.2021em;">designed. In addition to internally tracked latency, you also need a view on how &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:30.799em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.222em;">latency is perceived by your applications and what happens when that perceived &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:31.849em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.1012em;">latency increases. This means that besides tracking query latency from the database &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:32.899em;"><span class="stl_154 stl_32 stl_53" style="word-spacing:0.0448em;">server directly, you would also be well served by tooling the clients to report on time &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:33.949em;"><span class="stl_154 stl_32 stl_37" style="word-spacing:0.0721em;">to query completion, so you can get as close to the customer experience as possible. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:34.999em;"><span class="stl_154 stl_32 stl_53" style="word-spacing:0.1159em;">Digesting all of these sample metrics from clients (especially when your infrastruc‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:36.049em;"><span class="stl_154 stl_32 stl_48" style="word-spacing:0.0667em;">ture footprint grows) can be done with paid tools like Datadog or SolarWinds Data‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:37.099em;"><span class="stl_154 stl_32 stl_84" style="word-spacing:0.0605em;">base Performance Monitor, or even by using open source tools like PMM. This is an &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:38.149em;z-index:2008;"><span class="stl_154 stl_32 stl_71" style="word-spacing:0.0438em;">area where close collaboration with your organization</span><span class="stl_154 stl_32 stl_34">’</span><span class="stl_154 stl_32 stl_39" style="word-spacing:0.0413em;">s application developers is par‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:39.199em;z-index:2045;"><span class="stl_154 stl_32 stl_99" style="word-spacing:0.1102em;">amount. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_46" style="word-spacing:0.1065em;">u need to be aware of how the application team measures this from the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:40.249em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.1027em;">application perspective and add more insight to the outliers using tracing tools like &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:41.299em;"><span class="stl_154 stl_32 stl_148" style="word-spacing:0.0081em;">Honeycomb or Lightstep. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:43.1833em;"><span class="stl_180 stl_27 stl_28" style="word-spacing:0em;">Monitoring for Errors &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:45.0831em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.002em;">Do you need to track and alert on every error that ever happens? It depends. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:46.6331em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0051em;">The sheer existence of errors for a MySQL client in a running service is not an indica‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:47.6831em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.005em;">tion of something being definitely broken. In a world of distributed systems, there are &nbsp;</span></div>
					<div class="stl_01" style="left:29.5238em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">What to Measure &nbsp;</span></div>
					<div class="stl_01" style="left:34.4805em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:35.388em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">27 &nbsp;</span></div>
					<a name="49_0" style="position:absolute;left:0em;top:23.9423em;">&nbsp;</a>
					<a name="49_1" style="position:absolute;left:0em;top:43.4764em;">&nbsp;</a>
					<a name="49_2" style="position:absolute;left:0em;top:36.2782em;">&nbsp;</a>
					<a name="49_3" style="position:absolute;left:0em;top:45.3123em;">&nbsp;</a>
					<a name="49_4" style="position:absolute;left:0em;top:40.4782em;">&nbsp;</a>
					<a name="49_5" style="position:absolute;left:0em;top:18.3442em;">&nbsp;</a>
					<a name="49_6" style="position:absolute;left:0em;top:25.7782em;">&nbsp;</a>
					<a name="49_7" style="position:absolute;left:0em;top:37.3282em;">&nbsp;</a>
					<a name="49_8" style="position:absolute;left:0em;top:5.5958em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>