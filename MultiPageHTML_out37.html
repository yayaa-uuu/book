<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_44.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_44.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:5.9997em;top:4.366em;"><span class="stl_154 stl_32 stl_114" style="word-spacing:0.0922em;">MVCC works only with the </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.041em;">REPEATABLE READ </span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0872em;">and </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.041em;">READ COMMITTED </span><span class="stl_154 stl_32 stl_35" style="word-spacing:0.0899em;">isolation levels. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:5.4655em;"><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0604em;">READ UNCOMMITTED </span><span class="stl_154 stl_32 stl_128" style="word-spacing:0.0908em;">isn’t MVCC compatible</span><sup style="top: -0.2917em;"><a href="MultiPageHTML_out37.html#37_1"><span class="stl_166 stl_32 stl_28" style="word-spacing:0.2898em;">12 </span></a></sup><span class="stl_154 stl_32 stl_100" style="word-spacing:0.0787em;">because queries don’t read the row ver‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:6.5155em;"><span class="stl_154 stl_32 stl_71" style="word-spacing:0.0604em;">sion that’s appropriate for their transaction version; they read the newest version, no &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:7.6149em;"><span class="stl_154 stl_32 stl_115" style="word-spacing:0.2017em;">matter what. </span><span class="stl_170 stl_171 stl_28" style="word-spacing:-0.0576em;">SERIALIZABLE </span><span class="stl_154 stl_32 stl_100" style="word-spacing:0.2036em;">isn’t MVCC compatible because reads lock every row &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:8.6649em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">they return. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:10.5614em;"><span class="stl_159 stl_27 stl_28">Replication &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:12.8316em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.1733em;">MySQL is designed for accepting writes on one node at any given time. This has &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:13.8816em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.0908em;">advantages in managing consistency but leads to trade-offs when you need the data &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:14.9316em;"><span class="stl_154 stl_32 stl_39" style="word-spacing:0.1003em;">written in multiple servers or multiple locations. MySQL offers a native way to dis‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:15.9702em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0867em;">tribute writes that one node takes to additional nodes. This is referred to as </span><span class="stl_155 stl_41 stl_44">replica‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:17.0202em;"><span class="stl_155 stl_41 stl_81">tion</span><span class="stl_154 stl_32 stl_83" style="word-spacing:0.2187em;">. In MySQL, the source node has a thread per replica that is logged in as a &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:18.0816em;"><span class="stl_154 stl_32 stl_77" style="word-spacing:0.0226em;">replication client that wakes up when a write occurs, sending new data. In </span><a href="MultiPageHTML_out37.html#37_2"><span class="stl_184 stl_32 stl_204" style="word-spacing:-0.0048em;">Figure 1-3</span></a><span class="stl_154 stl_32 stl_204" style="word-spacing:-0.0048em;">, &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:19.1202em;"><span class="stl_154 stl_32 stl_39" style="word-spacing:0.0187em;">we show a simple example of this setup, which is usually called a </span><span class="stl_155 stl_41 stl_151" style="word-spacing:0.0245em;">topology tree </span><span class="stl_154 stl_32 stl_183" style="word-spacing:0.0095em;">of mul‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:20.1816em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0019em;">tiple MySQL servers in a source and replica setup. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:29.8561em;"><span class="stl_155 stl_41 stl_82" style="word-spacing:0.0125em;">Figure 1-3. A </span><span class="stl_216 stl_41 stl_28" style="word-spacing:-0.021em;">simpliﬁed </span><span class="stl_155 stl_41 stl_100" style="word-spacing:0.0105em;">view of a MySQL server replication topology &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:31.9175em;"><span class="stl_154 stl_32 stl_33" style="word-spacing:0.0093em;">For any data you run in production, you should use replication and have at least three &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:32.9675em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.2281em;">more replicas, ideally distributed in different locations (in cloud-hosted environ‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:34.0061em;"><span class="stl_154 stl_32 stl_36" style="word-spacing:0.0038em;">ments, known as </span><span class="stl_155 stl_41 stl_139">regions</span><span class="stl_154 stl_32 stl_37" style="word-spacing:-0.0004em;">) for disaster-recovery planning. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:35.5675em;"><span class="stl_154 stl_32 stl_95" style="word-spacing:0.041em;">Over the years, replication in MySQL gained more sophistication. Global transaction &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:36.6175em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0187em;">identifiers, multisource replication, parallel replication on replicas, and semisync rep‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:37.6675em;z-index:1400;"><span class="stl_154 stl_32 stl_72" style="word-spacing:0.2789em;">lication are some of the major updates. </span><span class="stl_154 stl_32 stl_52">W</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.2745em;">e </span><span class="stl_154 stl_32 stl_28">c</span><span class="stl_154 stl_32 stl_77" style="word-spacing:0.2777em;">over replication in great detail in &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:38.7175em;"><a href="MultiPageHTML_out249.html#249_0"><span class="stl_184 stl_32 stl_24" style="word-spacing:0.0054em;">Chapter 9</span></a><span class="stl_154 stl_32 stl_24" style="word-spacing:0.0054em;">. &nbsp;</span></div>
					<div class="stl_01" style="left:5.815em;top:47.3545em;"><span class="stl_167 stl_32 stl_28" style="word-spacing:0.273em;">12 </span><span class="stl_168 stl_32 stl_35" style="word-spacing:0.0028em;">There is no formal standard that defines MVCC, so different engines and databases implement it very differ‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.6667em;top:48.1878em;"><span class="stl_168 stl_32 stl_139" style="word-spacing:0.0102em;">ently, and no one can say any of them is wrong. &nbsp;</span></div>
					<div class="stl_01" style="left:30.9399em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">Replication &nbsp;</span></div>
					<div class="stl_01" style="left:34.4807em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:35.3882em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">15 &nbsp;</span></div>
					<a name="37_0" style="position:absolute;left:0em;top:10.913em;">&nbsp;</a>
					<a name="37_1" style="position:absolute;left:0em;top:47.4458em;">&nbsp;</a>
					<a name="37_2" style="position:absolute;left:0em;top:21.8734em;">&nbsp;</a>
					<a name="37_3" style="position:absolute;left:0em;top:8.8941em;">&nbsp;</a>
					<a name="37_4" style="position:absolute;left:0em;top:13.0609em;">&nbsp;</a>
					<a name="37_5" style="position:absolute;left:0em;top:4.5953em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>