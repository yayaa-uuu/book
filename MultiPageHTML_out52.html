<!DOCTYPE html><!--[if IE]>  <html class="stl_ie"> <![endif]-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>
		</title>
		<link rel="stylesheet" type="text/css" href="MultiPageHTML_out_files/style.css" />
	</head>
	<body>
		<div class="stl_ stl_02">
			<div class="stl_03">
				<object data="MultiPageHTML_out_files/img_59.svg" type="image/svg+xml" class="stl_04" style="position:absolute; width:42em; height:55.0833em;">
					<embed src="MultiPageHTML_out_files/img_59.svg" type="image/svg+xml" />
				</object>
			</div>
			<div class="stl_view">
				<div class="stl_05 stl_06">
					<div class="stl_01" style="left:6em;top:4.3166em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.1391em;">If tracking the rate of growth is not feasible (not all monitoring tools provide this &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:5.3666em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.1509em;">ability), you can set multiple thresholds with lower warnings that only fire during &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:6.4166em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0605em;">business hours and a higher, more critical value as an alert to off-hours on call. This &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:7.4666em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0639em;">allows the team to have a heads-up warning during business hours before things get &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:8.5166em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.0029em;">dire enough to wake someone up. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:10.0666em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.0715em;">If you can neither monitor the rate of growth nor define multiple thresholds for the &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:11.1166em;"><span class="stl_154 stl_32 stl_78" style="word-spacing:0.1516em;">same metric, then you have to at least determine a single-value threshold for disk &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:12.1666em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0528em;">space used at which you page your on-call engineers. This threshold needs to be low &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:13.2166em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0923em;">enough to allow some action and free disk space as the team assesses the reasons it &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:14.2666em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.4009em;">fired and consider longer-term mitigation. Consider evaluating the maximum &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:15.3166em;"><span class="stl_154 stl_32 stl_35" style="word-spacing:0.0841em;">throughput your disk can write (MB/s) and using that to help calculate how long at &nbsp;</span></div>
					<div class="stl_01" style="left:6.0001em;top:16.3666em;z-index:767;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.0351em;">max traffic throughput it would take to fill the disk. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_38" style="word-spacing:0.0387em;">u need that much lead time to &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:17.4166em;"><span class="stl_154 stl_32 stl_138" style="word-spacing:0.0074em;">avoid an event. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:18.9666em;z-index:805;"><span class="stl_154 stl_32 stl_52" style="word-spacing:0.2421em;">We </span><span class="stl_154 stl_32 stl_28">d</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0481em;">iscuss in </span><a href="MultiPageHTML_out97.html#97_0"><span class="stl_184 stl_32 stl_99" style="word-spacing:0.0545em;">Chapter 4 </span></a><span class="stl_154 stl_32 stl_39" style="word-spacing:0.0516em;">operating system and hardware configurations that relate to &nbsp;</span></div>
					<div class="stl_01" style="left:5.9996em;top:20.0166em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.15em;">how MySQL uses disk space and what trade-offs to consider in those decisions in &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:21.0666em;z-index:1010;"><span class="stl_154 stl_32 stl_222" style="word-spacing:0.159em;">relation to disk space growth. It should be expected that at some point, hopefully, &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:22.1166em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0361em;">your business will have grown so that you cannot store all of your data in one cluster &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:23.1666em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0465em;">of servers. Even if you run in a cloud environment that can expand volumes for you, &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:24.2166em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.0427em;">you still need to do planning around this, so you always want to have a threshold for &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:25.2666em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0251em;">free disk space that allows you the time to plan and do the needed expansion without &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:26.3166em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">a panic. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:27.8666em;"><span class="stl_154 stl_32 stl_57" style="word-spacing:0.1375em;">The takeaway here is to make sure you have some monitor for disk space growth, &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:28.9166em;"><span class="stl_154 stl_32 stl_140" style="word-spacing:0.0481em;">even if you think it is early days and too soon to need one. This is one of the growth &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:29.9666em;"><span class="stl_154 stl_32 stl_74" style="word-spacing:0.0016em;">axes that catches almost everyone unprepared. &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:32.0235em;"><span class="stl_193 stl_27 stl_28" style="word-spacing:0em;">Connection growth &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:33.4909em;z-index:1552;"><span class="stl_154 stl_32 stl_24" style="word-spacing:0.033em;">As your business grows, a common layer that grows linearly is your application layer. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:34.5409em;z-index:1554;"><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.0029em;">u will need more instances to support login, shopping carts, processing requests, or &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:35.5909em;"><span class="stl_154 stl_32 stl_73" style="word-spacing:0.0579em;">whatever the context of the product may be. All of these added instances start open‐ &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:36.6409em;z-index:1743;"><span class="stl_154 stl_32 stl_88" style="word-spacing:0.0011em;">ing more and more connections to your database hosts. </span><span class="stl_154 stl_32 stl_109">Y</span><span class="stl_154 stl_32 stl_28">o</span><span class="stl_154 stl_32 stl_132" style="word-spacing:0.0066em;">u may mitigate that growth &nbsp;</span></div>
					<div class="stl_01" style="left:6.0003em;top:37.6909em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.1147em;">for some time by adding replicas, using replication as a scale-out measure, or even &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:38.7409em;"><span class="stl_154 stl_32 stl_53" style="word-spacing:0.0013em;">using middleware layers like ProxySQL to decouple the growth of your frontend from &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:39.7909em;"><span class="stl_154 stl_32 stl_53" style="word-spacing:0.0013em;">connection load directly on the database. &nbsp;</span></div>
					<div class="stl_01" style="left:6em;top:41.3409em;"><span class="stl_154 stl_32 stl_37" style="word-spacing:0.0096em;">While your traffic is growing, the database server can support a finite pool of connec‐ &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:42.4404em;"><span class="stl_154 stl_32 stl_112" style="word-spacing:0.211em;">tions, which is configured as the server setting </span><span class="stl_170 stl_171 stl_28">max_connections</span><span class="stl_154 stl_32 stl_28" style="word-spacing:0.2128em;">. Once the total &nbsp;</span></div>
					<div class="stl_01" style="left:6.0004em;top:43.4904em;"><span class="stl_154 stl_32 stl_95" style="word-spacing:0.0954em;">number of connections to the server reaches that maximum, your database will not &nbsp;</span></div>
					<div class="stl_01" style="left:6.0002em;top:44.5404em;"><span class="stl_154 stl_32 stl_97" style="word-spacing:0.1016em;">allow any new ones, which is a common contributing cause to incidents where you &nbsp;</span></div>
					<div class="stl_01" style="left:5.9999em;top:45.5904em;"><span class="stl_154 stl_32 stl_158" style="word-spacing:0.0694em;">can no longer open new connections to the database, leading to increased errors for &nbsp;</span></div>
					<div class="stl_01" style="left:5.9997em;top:46.6404em;"><span class="stl_154 stl_32 stl_28" style="word-spacing:0em;">your users. &nbsp;</span></div>
					<div class="stl_01" style="left:5.9998em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">30 &nbsp;</span></div>
					<div class="stl_01" style="left:7.3618em;top:50.8098em;"><span class="stl_80 stl_27 stl_28">|</span></div>
					<div class="stl_01" style="left:8.2693em;top:50.8098em;"><span class="stl_80 stl_27 stl_28" style="word-spacing:0em;">Chapter 2: Monitoring in a Reliability Engineering World &nbsp;</span></div>
					<a name="52_0" style="position:absolute;left:0em;top:33.7202em;">&nbsp;</a>
				</div>
			</div>
		</div>
	</body>
</html>